<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Harry Undersand — Développeur & Solutions IA</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:Inter;background:#0b141a;color:#e9edef}
header{position:fixed;top:0;width:100%;background:rgba(11,20,26,.9);
backdrop-filter:blur(15px);border-bottom:1px solid rgba(139,92,246,.35)}
.navbar{max-width:1200px;margin:auto;padding:16px 24px;
display:flex;justify-content:space-between;align-items:center}
.logo{color:#8b5cf6;font-weight:800;text-decoration:none}
.auth-actions{display:flex;gap:10px;align-items:center}
.auth-actions img{width:32px;height:32px;border-radius:50%}
.btn{padding:10px 20px;border-radius:25px;border:none;
cursor:pointer;font-weight:600}
.btn-primary{background:#8b5cf6;color:#fff}
.btn-outline{background:none;border:1px solid rgba(139,92,246,.35);color:#fff}
.hero{padding-top:160px;text-align:center}
.modal-bg{position:fixed;inset:0;background:rgba(0,0,0,.6);
display:none;align-items:center;justify-content:center;z-index:2000}
.modal{background:#111b21;border:1px solid rgba(139,92,246,.35);
padding:30px;border-radius:18px;width:100%;max-width:420px}
.modal input,.modal textarea{width:100%;margin:8px 0;padding:10px;border-radius:10px;border:none}
</style>
</head>

<body>

<header>
<div class="navbar">
<a class="logo" href="/">Amateur De Fantaisie</a>

<div class="auth-actions" id="authGuest">
<button class="btn btn-outline" id="loginBtn">Connexion</button>
<button class="btn btn-primary" id="registerBtn">Créer un compte</button>
</div>

<div class="auth-actions" id="authUser" style="display:none">
<img id="userPhoto">
<span id="userName"></span>
<button class="btn btn-outline" id="logoutBtn">Déconnexion</button>
</div>
</div>
</header>

<section class="hero">
<h1>Harry Undersand</h1>
<p>IA • Cloud • Automatisation</p>
</section>

<!-- LOGIN -->
<div class="modal-bg" id="loginModal">
<div class="modal">
<h3>Connexion</h3>
<input id="loginEmail" placeholder="Email">
<input id="loginPassword" type="password" placeholder="Mot de passe">
<button class="btn btn-primary" id="doLogin">Connexion</button>
<hr>
<button class="btn btn-outline" id="googleLogin">Google</button>
<button class="btn btn-outline" id="githubLogin">GitHub</button>
</div>
</div>

<!-- REGISTER -->
<div class="modal-bg" id="registerModal">
<div class="modal">
<h3>Créer un compte</h3>
<input id="registerEmail" placeholder="Email">
<input id="registerPassword" type="password" placeholder="Mot de passe">
<button class="btn btn-primary" id="doRegister">Créer</button>
</div>
</div>

<!-- COMMANDE -->
<div class="modal-bg" id="orderModal">
<div class="modal">
<h3>Nouvelle commande</h3>
<input id="orderService" placeholder="Service">
<textarea id="orderMessage" placeholder="Détails"></textarea>
<button class="btn btn-primary" id="sendOrder">Envoyer</button>
</div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
import {
  getAuth,onAuthStateChanged,signOut,
  signInWithEmailAndPassword,
  createUserWithEmailAndPassword,
  GoogleAuthProvider, GithubAuthProvider,
  signInWithPopup
} from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";
import {
  getFirestore, doc, setDoc,
  collection, addDoc, serverTimestamp
} from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBdo7NO1PnAa90PhEhuzpllkB1ESGZu3J8",
  authDomain: "harry-undersand.firebaseapp.com",
  projectId: "harry-undersand"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const googleProvider = new GoogleAuthProvider();
const githubProvider = new GithubAuthProvider();

/* UI */
loginBtn.onclick = ()=>loginModal.style.display="flex";
registerBtn.onclick = ()=>registerModal.style.display="flex";
loginModal.onclick = e=>e.target===loginModal&&(loginModal.style.display="none");
registerModal.onclick = e=>e.target===registerModal&&(registerModal.style.display="none");

/* EMAIL LOGIN */
doLogin.onclick = async()=>{
  await signInWithEmailAndPassword(auth, loginEmail.value, loginPassword.value);
  loginModal.style.display="none";
};

/* REGISTER */
doRegister.onclick = async()=>{
  const cred = await createUserWithEmailAndPassword(
    auth, registerEmail.value, registerPassword.value
  );
  await createUserProfile(cred.user);
  registerModal.style.display="none";
};

/* GOOGLE */
googleLogin.onclick = async()=>{
  const cred = await signInWithPopup(auth, googleProvider);
  await createUserProfile(cred.user);
  loginModal.style.display="none";
};

/* GITHUB */
githubLogin.onclick = async()=>{
  const cred = await signInWithPopup(auth, githubProvider);
  await createUserProfile(cred.user);
  loginModal.style.display="none";
};

/* PROFILE FIRESTORE */
async function createUserProfile(user){
  await setDoc(doc(db,"users",user.uid),{
    uid:user.uid,
    email:user.email,
    name:user.displayName||"",
    photo:user.photoURL||"",
    provider:user.providerData[0].providerId,
    createdAt:serverTimestamp()
  },{merge:true});
}

/* COMMANDES */
sendOrder.onclick = async()=>{
  await addDoc(collection(db,"orders"),{
    uid:auth.currentUser.uid,
    service:orderService.value,
    message:orderMessage.value,
    status:"en attente",
    createdAt:serverTimestamp()
  });
  alert("Commande envoyée");
  orderModal.style.display="none";
};

/* AUTH STATE */
onAuthStateChanged(auth, user=>{
  if(!user){
    authGuest.style.display="flex";
    authUser.style.display="none";
    return;
  }
  authGuest.style.display="none";
  authUser.style.display="flex";
  userName.textContent = user.displayName||user.email;
  userPhoto.src = user.photoURL||"https://i.imgur.com/6VBx3io.png";
});

/* LOGOUT */
logoutBtn.onclick = async()=>{
  await signOut(auth);
  location.reload();
};
</script>

</body>
</html>
