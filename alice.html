<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Alice ‚Äî Chat IA</title>

  <!-- Botpress -->
  <script src="https://cdn.botpress.cloud/webchat/v3.5/inject.js"></script>

  <!-- Firebase (ES Modules) -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBdo7NO1PnAa90PhEhuzpllkB1ESGZu3J8",
      authDomain: "harry-undersand.firebaseapp.com",
      projectId: "harry-undersand"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // üîê Protection de la page
    onAuthStateChanged(auth, user => {
      if (!user) {
        window.location.href = "login.html"; // ‚¨ÖÔ∏è page de connexion
      }
    });
  </script>

  <style>
    html, body {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
      background: #0a0a0f;
      font-family: Inter, system-ui, sans-serif;
      overflow: hidden;
    }

    /* Barre du haut */
    .topbar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 56px;
      background: rgba(10,10,15,0.95);
      display: flex;
      align-items: center;
      padding: 0 16px;
      z-index: 10;
      border-bottom: 1px solid rgba(255,255,255,0.08);
    }

    .back-btn {
      color: #a3a3ff;
      text-decoration: none;
      font-weight: 600;
      font-size: 0.95rem;
    }

    .back-btn:hover {
      color: #fff;
    }

    /* Zone chatbot */
    #webchat {
      position: absolute;
      top: 56px;
      left: 0;
      right: 0;
      bottom: 0;
    }

    #webchat .bpWebchat {
      width: 100%;
      height: 100%;
      max-width: 100%;
      max-height: 100%;
    }

    /* Supprimer bouton flottant */
    #webchat .bpFab {
      display: none !important;
    }
  </style>
</head>

<body>

  <!-- Barre du haut -->
  <div class="topbar">
    <a href="index.html" class="back-btn">‚Üê Retour au site</a>
  </div>

  <!-- Chatbot -->
  <div id="webchat"></div>

  <!-- Init Botpress -->
  <script>
    function startBotpress() {
      if (!window.botpress) {
        return setTimeout(startBotpress, 100);
      }

      window.botpress.init({
        botId: "e4fdf004-40f4-4904-b6a8-53eb475d506e",
        clientId: "9efd43de-fb4a-4a8a-abf5-42d69fb1b5a7",
        selector: "#webchat",

        configuration: {
          version: "v2",
          botName: "Alice",
          composerPlaceholder: "Posez votre question √† Alice‚Ä¶",
          themeMode: "dark",
          fontFamily: "Inter",
          color: "#3276EA",
          radius: 6,

          allowFileUpload: true,
          soundEnabled: true,
          feedbackEnabled: true,

          botAvatar: "https://files.bpcontent.cloud/2025/12/11/13/20251211133410-XE4M25HS.jpeg",
          botDescription: "Alice, votre conseill√®re digitale rapide, fiable et toujours √† vos c√¥t√©s."
        }
      });
    }

    startBotpress();
  </script>

</body>
</html>
